doctype html
html(lang='en')
  head
    title KIWI Booking System
    include includes/css_link.pug

    // css style for booking form
    style.
      #formtitle {
      text-align: center;
      font-family: allura;
      font-size: 60px;
      line-height: 1;
      padding: 0;
      margin: 0;
      color: white;
      text-shadow: 1px 1px 2px #292929, -1px -1px 0.5px #292929;
      }
      #form_container {
      box-shadow: 2px 2px 8px #292929;
      border: none;
      }      

    // css style for tab menu
    style.
      body {font-family: Arial;}
      #tab_container {
      padding: 1% 6%;
      align: left;
      }
      /* Style the tab */
      .tab {
      overflow: hidden;
      border: 1px solid #ccc;
      border-radius:6px;
      background-color: #f1f1f1;
      }
      /* Style the buttons inside the tab */
      .tab button {
      background-color: inherit;
      float: left;
      border: none;
      outline: none;
      cursor: pointer;
      padding: 14px 16px;
      transition: 0.3s;
      font-size: 17px;
      }
      .tab button:hover {
      background-color: #ddd;
      color: black;
      }
      /* Create an active/current tablink class */
      .tab button.active {
      background-color: #ccc;
      }
      /* Style the tab content */
      .tabcontent {
      display: none;
      padding: 0% 6%;
      border: none;
      }
      #btn01 {
      color: purple;
      }
      #btn02 {
      color: blue;
      }
      #btn03 {
      color: pink;
      }
      #btn04 {
      color: green;
      }
      #btn05 {
      color: orange;
      }
 
    //calendar
    include includes/calendar.pug

  body.goto-here
    include includes/nav.pug
    // TITLE 
    .hero-wrap.hero-bread(style="background-image: url('images/bg_6.jpg');")
      .container
        .row.no-gutters.slider-text.align-items-center.justify-content-center
          .col-md-9.ftco-animate.text-center
            p.breadcrumbs
              span.mr-2
                a(href='/') Home
              span Booking
            h1.mb-0.bread Booking 
            h1.mb-0.bread - Facilities Reservation -
    // CONTENT

    section.ftco-section.contact-section.bg-light
      // CALENDAR
      .row.justify-content-center
        .container#tab_container
          .tab
            button#defaultOpen.tablinks(onclick="openCalendar(event, 'all')") All
            button#btn01.tablinks(onclick="openCalendar(event, 'cal01')") Comm Hall 01
            button#btn02.tablinks(onclick="openCalendar(event, 'cal02')") Dining Hall 02
            button#btn03.tablinks(onclick="openCalendar(event, 'cal03')") Heritage Room 03
            button#btn04.tablinks(onclick="openCalendar(event, 'cal04')") Multi Purpose Court 04
            button#btn05.tablinks(onclick="openCalendar(event, 'cal05')") Squash Court 05
            button#defaultOpen.tablinks(onclick="openCalendar(event, 'cal06')") Tennis Court 06
            button#btn01.tablinks(onclick="openCalendar(event, 'cal07')") KEWOC Room 07
            button#btn02.tablinks(onclick="openCalendar(event, 'cal08')") Marketing Room 08
            button#btn03.tablinks(onclick="openCalendar(event, 'cal09')") Dance Studio 09
            button#btn04.tablinks(onclick="openCalendar(event, 'cal10')") Recreation Room 10
            button#btn05.tablinks(onclick="openCalendar(event, 'cal11')") BBQ Pit 11
            button#defaultOpen.tablinks(onclick="openCalendar(event, 'cal12')") Incub Room 12
            button#btn01.tablinks(onclick="openCalendar(event, 'cal13')") Band Room 13           
        br  
        #all.tabcontent
          #calendar_all
        #cal01.tabcontent
          #calendar_01
        #cal02.tabcontent
          #calendar_02
        #cal03.tabcontent
          #calendar_03
        #cal04.tabcontent
          #calendar_04
        #cal05.tabcontent
          #calendar_05
        #cal06.tabcontent
          #calendar_06
        #cal07.tabcontent
          #calendar_07
        #cal08.tabcontent
          #calendar_08
        #cal09.tabcontent
          #calendar_09
        #cal10.tabcontent
          #calendar_10 
        #cal11.tabcontent
          #calendar_11
        #cal12.tabcontent
          #calendar_12
        #cal13.tabcontent
          #calendar_13                 
        br  
        br

      // BOOKING FORM
      .container#form_container
        .row.justify-content-center
          
          //action='/feedback-res-sent', , method='post', enctype='multipart/form-data'
          form#myForm.bg-white.p-5.contact-form(name='submit-to-google-sheet', action='', method='post', enctype='multipart/form-data', autocomplete='on')
            .row.justify-content-center
              p#formtitle Facilities Reservation Form
            .row.justify-content-center
              p(style='color:Tomato;') Please ensure your booking is made 3 days in advance.  

            .row.align-items-end
              .col-md-12
                .form-group
                  label(for='name') Name of CCA
                  input.form-control(type='text', name='cca_name', required='required')
              .col-md-12
                .form-group
                  label(for='purpose') Purpose
                  input.form-control(type='text', name='purpose', required='required')
              .col-md-6
                .form-group
                  label(for='venue') Venue
                  select.form-control(type='text', name='venue', required='required')
                    option(value='Dining Hall 01') Dining Hall 01
                    option(value='Comm Hall 02') Comm Hall 02
                    option(value='Study Room 03') Study Room 03
                    option(value='Marketing Room 04') Marketing Room 04
                    option(value='Incub Room 05') Incub Room 05
              .col-md-6
                .form-group
                  label(for='email') Email
                  input.form-control(type='email', name='email', required='required')
                  //input#datepicker.form-control(type='text', name='date', required='required')
              .col-md-4
                .form-group
                  label(for='date') Date
                  input#date.form-control(type='date', name='date', required='required', max='2019-12-31')
              .col-md-4
                .form-group
                  label(for='starttime') Start Time
                  input#starttime.form-control(type='time', name='starttime', required='required', min='2019-06-10T00:00', max='2019-12-31T00:00')    
              .col-md-4
                .form-group
                  label(for='endtime') End Time
                  input#endtime.form-control(type='time', name='endtime', required='required', max='2019-12-31T00:00')
              .form-group
                input#submitbtn.btn.btn-primary.py-3.px-5(type='submit', value='Book Now!')
 
    script.
      var today = new Date();
      var min_date = new Date(today.getTime()+1000*60*60*24*3).toISOString().split('T')[0]; // 3 days after today
      console.log(min_date); 
      document.getElementById("date").setAttribute("min", min_date);   

    //to submit html form content to google sheet (url below linked to Google Script webApp)
    script.
      const scriptURL = 'https://script.google.com/macros/s/AKfycbwoDCDD5Ju9lLDGGK_0YSrV5EACOdDv9VpJg7HZTzJDSfgSUSw/exec'
      const form = document.forms['submit-to-google-sheet']
      form.addEventListener('submit', e => {
      // prevent form submission  
      e.preventDefault();

      // prevent user from entering endtime that is before the starttime
      var start = document.getElementById("starttime").value;
      var end = document.getElementById("endtime").value;
      if(start >= end) {
      alert("End Time must be after Start Time!");     
      console.log('ohhhh!');
      return false;  // back to the original form 
      }

      //submit the form to google sheet
      fetch(scriptURL, { method: 'POST', body: new FormData(form)})
      .then(response => console.log('Success!', response))
      .catch(error => console.error('Error!', error.message))
      window.location.href = "/booking-sent";
      })

    script.
      function openCalendar(evt, calName) {
      var i, tabcontent, tablinks;
      tabcontent = document.getElementsByClassName("tabcontent");
      for (i = 0; i < tabcontent.length; i++) {
      tabcontent[i].style.display = "none";
      }
      tablinks = document.getElementsByClassName("tablinks");
      for (i = 0; i < tablinks.length; i++) {
      tablinks[i].className = tablinks[i].className.replace(" active", "");
      }
      document.getElementById(calName).style.display = "block";
      evt.currentTarget.className += " active";
      }
      // Get the element with id="defaultOpen" and click on it
      document.getElementById("defaultOpen").click();      
                
    
    // FOOTER
    include includes/footer.pug